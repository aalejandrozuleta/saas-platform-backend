FROM node:24-alpine

RUN corepack enable && corepack prepare pnpm@latest --activate

WORKDIR /app

# Workspace
COPY pnpm-workspace.yaml ./
COPY package.json ./
COPY pnpm-lock.yaml ./

# Copiar manifests
COPY services/auth-service/package.json services/auth-service/
COPY shared/package.json shared/

# ðŸ”´ INSTALAR DEPENDENCIAS DEL SERVICIO (CLAVE)
RUN pnpm install --filter auth-service...

# Copiar cÃ³digo
COPY services/auth-service services/auth-service
COPY shared shared

WORKDIR /app/services/auth-service

EXPOSE 3001
CMD ["pnpm", "dev"]
